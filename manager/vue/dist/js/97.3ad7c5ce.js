"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[97],{2097:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入挂号状态"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",plain:""},on:{click:function(t){return e.load(1)}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",plain:""},on:{click:e.reset}},[e._v("重置")])],1),"ADMIN"===e.user.role?t("div",{staticClass:"operation"},[t("el-button",{attrs:{type:"danger",plain:""},on:{click:e.delBatch}},[e._v("批量删除")])],1):e._e(),t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,stripe:""}},["ADMIN"===e.user.role&&"已叫号"===e.status?t("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}):e._e(),t("el-table-column",{attrs:{prop:"id",label:"序号",width:"80",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"userName",label:"患者姓名","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"doctorName",label:"医生姓名","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"time",label:"挂号时间"}}),t("el-table-column",{attrs:{prop:"status",label:"挂号状态"}}),t("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return["USER"===e.user.role?t("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(t){return e.del(s.row)}}},[e._v("取消挂号 ")]):e._e(),"DOCTOR"===e.user.role?t("el-button",{attrs:{plain:"",type:"warning",size:"mini"},on:{click:function(t){return e.call(s.row)}}},[e._v("叫号 ")]):e._e(),"USER"!==e.user.role?t("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(t){return e.del(s.row)}}},[e._v("删除记录 ")]):e._e()]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)])},r=[],l={name:"Reserve",data(){return{tableData:[],pageNum:1,pageSize:10,total:0,status:null,fromVisible:!1,form:{},user:JSON.parse(localStorage.getItem("xm-user")||"{}"),rules:{},ids:[]}},created(){this.load(1)},methods:{call(e){let t=JSON.parse(JSON.stringify(e));t.status="已叫号",this.$request.put("/reserve/update",t).then((t=>{"200"===t.code&&(this.$message.success("叫号成功"),this.load(1),this.record(e))}))},record(e){let t={userId:e.userId,doctorId:e.doctorId};this.$request.post("/record/add",t).then((e=>{"200"===e.code?this.$message.success("数据同步成功"):this.$message.error(e.msg)}))},del(e){if("未叫号"!==e.status||"USER"===this.user.role)return"USER"===this.user.role?"已叫号"===e.status?void this.$message.warning("已叫号，无法取消"):void this.$confirm("您确定取消挂号么","操作确认",{type:"warning"}).then((t=>{this.$request.delete("/reserve/delete/"+e.id).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{})):void this.$confirm("确定删除么，删除后无法恢复，请谨慎操作","操作确认",{type:"warning"}).then((t=>{this.$request.delete("/reserve/delete/"+e.id).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{}));this.$message.warning("您无法删除未叫号的患者")},handleSelectionChange(e){this.ids=e.map((e=>e.id))},delBatch(){this.ids.length?this.$confirm("您确定批量删除这些数据吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/reserve/delete/batch",{data:this.ids}).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{})):this.$message.warning("请选择数据")},load(e){e&&(this.pageNum=e),this.$request.get("/reserve/selectPage",{params:{pageNum:this.pageNum,pageSize:this.pageSize,title:this.title}}).then((e=>{this.tableData=e.data?.list,this.total=e.data?.total}))},reset(){this.title=null,this.load(1)},handleCurrentChange(e){this.load(e)}}},i=l,n=s(3736),o=(0,n.Z)(i,a,r,!1,null,"0c386fc0",null),c=o.exports}}]);
//# sourceMappingURL=97.3ad7c5ce.js.map